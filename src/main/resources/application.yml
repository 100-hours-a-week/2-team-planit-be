spring: # Spring Boot 핵심 설정 루트
  profiles: # 활성화할 프로파일 정의
    active: local # 기본은 로컬 개발용 프로파일
  application:
    name: travel-service
  jackson: # JSON 직렬화/역직렬화 타임존을 KST로 고정
    time-zone: Asia/Seoul
  jpa: # Hibernate JDBC 타임존을 KST로 고정
    properties:
      hibernate:
        jdbc:
          time_zone: Asia/Seoul

server: # 내장 서버 구성
  port: 8080
  servlet: # 서블릿 관련 설정
    context-path: /api # 전체 API에 붙일 context-path
  tomcat: # Tomcat 스레드 풀 설정 (재시도 로직 고려 - 마이그레이션 기간 동안 증가)
    threads:
      max: 400 # 최대 스레드 수 (재시도 중 최대 69.3초 대기 고려하여 증가, 마이그레이션 완료 후 200으로 복원 권장)
      min-spare: 20 # 최소 유휴 스레드 수 (재시도 시나리오 고려하여 증가)

cloud:
  aws:
    enabled: true
    s3:
      bucket: ${AWS_S3_BUCKET}
    region:
      static: ${AWS_REGION}

---

# prod 환경은 실제 배포에서만 활성화하세요.
# prod 프로파일을 실행하려면 아래 환경변수들을 반드시 채워야 합니다.
# SPRING_DATASOURCE_URL, SPRING_DATASOURCE_USERNAME, SPRING_DATASOURCE_PASSWORD
# JWT_SECRET, AWS_S3_BUCKET, AWS_REGION, AWS_ACCESS_KEY, AWS_SECRET_KEY

ai:
  base-url: http://localhost:8000
  mock-enabled: false

trip:
  create-window-enabled: true
  daily-create-limit-enabled: true

planit:
  profile:
    default-image-url: https://${planit.cloudfront.domain}/default-profile.png
  cloudfront:
    domain: ${CLOUDFRONT_DOMAIN:}

  # DB 마이그레이션 중 쓰기 요청 재시도 설정
  db:
    retry:
      enabled: true # 재시도 기능 활성화 여부 (마이그레이션 완료 후 false로 변경 가능)
      max-attempts: 5 # 최대 재시도 횟수
      initial-interval: 300 # 초기 재시도 간격 (ms) - 0.3초
      multiplier: 5.0 # 재시도 간격 배수 (지수 백오프)
      max-interval: 30000 # 최대 재시도 간격 (ms) - 30초
      # 재시도 간격: 0.3초 → 1.5초 → 7.5초 → 30초 → 30초
      # 총 대기 시간: 약 69.3초 (1.15분)

